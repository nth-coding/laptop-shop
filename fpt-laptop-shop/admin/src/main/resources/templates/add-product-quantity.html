<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments::header}">
    <!-- Add Bootstrap CDN link -->
</head>

<body id="page-top">

<!-- Page Wrapper -->
<div id="wrapper">

    <!-- Sidebar -->
    <ul th:replace="~{fragments::sidebar}">
    </ul>
    <!-- End of Sidebar -->
    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

        <!-- Main Content -->
        <div id="content">

            <!-- Topbar -->
            <nav th:replace="~{fragments::top-navbar}">
            </nav>
            <!-- End of Topbar -->

            <div class="container">
                <h2 class="my-4">Cập Nhật Số Lượng Sản Phẩm</h2>
                <form action="#" th:action="@{/update-product-quantity}" method="post" class="mb-4">

                    <div class="form-group">
                        <label for="productDto">Chọn Sản Phẩm:</label>
                        <select class="form-control" id="productDto" name="productDto">
                            <!-- Thymeleaf iteration for product options -->
                            <option th:each="product : ${products}" th:value="${product.id}"
                                    th:text="${product.name}"></option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="quantity">Số Lượng Mới:</label>
                        <input type="number" class="form-control" id="quantity" name="quantity"
                               placeholder="Nhập số lượng mới">
                    </div>

                    <button type="submit" class="btn btn-primary submit-btn">Cập Nhật Số Lượng</button>
                </form>

            <!-- Import History Table -->
            <h2 class="my-4 p-2">Lịch Sử Nhập Hàng</h2>
            <table class="table table-striped">
                <thead>
                <tr>
                    <th>STT</th>
                    <th>Sản Phẩm</th>
                    <th>Số Lượng</th>
                    <th>Người nhập</th>
                    <th>Ngày Nhập Hàng</th>
                </tr>
                </thead>
                <tbody>
                <!-- Thymeleaf iteration for import history -->
                <tr th:each="history : ${importHistory}">
                    <td th:text="${history.id}"></td>
                    <td th:text="${history.product.name}"></td>
                    <td th:text="'+ ' + ${history.quantity}"></td>
                    <td th:text="${history.admin.firstName + ' ' + history.admin.lastName}"></td>
                    <td th:text="${#dates.format(history.createdDate, 'dd-MM-yyyy HH:mm')}"></td>
                </tr>
                </tbody>
            </table>
            </div>
        </div>
    <!-- End of Main Content -->

    <!-- Footer -->
    <footer th:replace="~{fragments::footer}">
    </footer>
    <!-- End of Footer -->

</div>
<!-- End of Content Wrapper -->

</div>
<!-- End of Page Wrapper -->

<!-- Scroll to Top Button-->
<a th:replace="~{fragments::scroll}">
</a>

<!-- Bootstrap core JavaScript-->
<div th:replace="~{fragments::script}"></div>

</body>
<script>
    document.querySelector('.submit-btn').addEventListener('click', function(event) {
        var quantity = document.getElementById('quantity').value;

        if (quantity === '') {
            alert('Quantity must not be empty');
            event.preventDefault(); // Prevent form submission
        } else if (quantity <= 0) {
            alert('Quantity must be greater than 0');
            event.preventDefault(); // Prevent form submission
        }
    });
</script>
</html>
